<!doctype html>
<html lang="en">
<head>
	<meta charset="UTF-8" />
	<title>MICHAEL SAYS</title>
    <script src="//cdn.jsdelivr.net/phaser/2.4.3/phaser.min.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.3.5.js"></script>
    <style type="text/css">
        body {
            margin: 0;
        }
    </style>
</head>
<body>

<script type="text/javascript">

var _socketEnabled = true;

if (_socketEnabled) {
	var socket = io.connect('http://localhost:3000');
	  socket.on('news', function (data) {
	    console.log(data);
	  });
	  socket.on('hit', function (data) {
	    console.log(data.sound);
	    switch(data.sound) {
	    	case 1:
	    		hit1();
	    		break;
    		case 2:
    			hit2();
    			break;
  			case 3:
    			hit3();
    			break;
  			case 4:
    			hit4();
    			break;
  			case 5:
    			hit5();
    			break;
	    	default:
	    		break;
	    }
	  });
}

function RGBtoHEX(r, g, b) {
	return r << 16 | g << 8 | b;
}

var game = new Phaser.Game(1280, 720, Phaser.AUTO, '', { preload: preload, create: create, update: update });
var circles;
var circleGrowDuration = 2000;
var text;

// Keyboard input
var key1;
var key2;
var key3;
var key4;
var key5;
var key6;
var key7;
var key8;
var key9;
var key0;

// Sounds
var sfx1;
var sfx2;
var sfx3;
var sfx4;
var sfx5;
var sfx6;
var sfx7;
var sfx8;
var sfx9;
var sfx10;

function hit1 () {
	if (hit1Tween !== undefined) {
		hit1Tween.stop(false);
	}
	circles.children[0].scale.setTo(0, 0);
	var hit1Tween = game.add.tween(circles.children[0].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit2 () {
	if (hit2Tween !== undefined) {
		hit2Tween.stop(false);
	}
	circles.children[1].scale.setTo(0, 0);
	var hit2Tween = game.add.tween(circles.children[1].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit3 () {
	if (hit3Tween !== undefined) {
		hit3Tween.stop(false);
	}
	circles.children[2].scale.setTo(0, 0);
	var hit3Tween = game.add.tween(circles.children[2].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit4 () {
	if (hit4Tween !== undefined) {
		hit4Tween.stop(false);
	}
	circles.children[3].scale.setTo(0, 0);
	var hit4Tween = game.add.tween(circles.children[3].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit5 () {
	if (hit5Tween !== undefined) {
		hit5Tween.stop(false);
	}
	circles.children[4].scale.setTo(0, 0);
	var hit5Tween = game.add.tween(circles.children[4].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit6 () {
	if (hit6Tween !== undefined) {
		hit6Tween.stop(false);
	}
	circles.children[5].scale.setTo(0, 0);
	var hit6Tween = game.add.tween(circles.children[5].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit7 () {
	if (hit7Tween !== undefined) {
		hit7Tween.stop(false);
	}
	circles.children[6].scale.setTo(0, 0);
	var hit7Tween = game.add.tween(circles.children[6].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit8 () {
	if (hit8Tween !== undefined) {
		hit8Tween.stop(false);
	}
	circles.children[7].scale.setTo(0, 0);
	var hit8Tween = game.add.tween(circles.children[7].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit9 () {
	if (hit9Tween !== undefined) {
		hit9Tween.stop(false);
	}
	circles.children[8].scale.setTo(0, 0);
	var hit9Tween = game.add.tween(circles.children[8].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}
function hit0 () {
	if (hit10Tween !== undefined) {
		hit10Tween.stop(false);
	}
	circles.children[9].scale.setTo(0, 0);
	var hit10Tween = game.add.tween(circles.children[9].scale).to( { x: 1, y: 1 }, 1000, Phaser.Easing.Linear.None, true );
}

function preload() {
  game.load.image('circle', 'assets/circle.png');
  game.load.audio('sfx1', ['assets/d-in-g.mp3', 'assets/d-in-g.ogg']);
  game.load.audio('sfx2', 'assets/Clarinet.mp3');
  game.load.audio('sfx3', 'assets/French_Horn.mp3');
  game.load.audio('sfx4', 'assets/Jazz_Organ.mp3');
  game.load.audio('sfx5', 'assets/Mellotron_Choir.mp3');

  game.time.advancedTiming = true;
}

function create() {
	// A simple background for our game
  //game.add.sprite(0, 0, 'sky');
  game.stage.backgroundColor = RGBtoHEX(230, 230, 230);

  // Sound playback event prep
  sfx1 = game.add.audio('sfx1');
  sfx2 = game.add.audio('sfx2');
  sfx3 = game.add.audio('sfx3');
  sfx4 = game.add.audio('sfx4');
  sfx5 = game.add.audio('sfx5');
  sfx6 = game.add.audio('sfx6');
  sfx7 = game.add.audio('sfx7');
  sfx8 = game.add.audio('sfx8');
  sfx9 = game.add.audio('sfx9');
  sfx10 = game.add.audio('sfx10');

	circles = game.add.group();
	circles.enableBody = false;

	// Map keyboard buttons
	key1 = game.input.keyboard.addKey(Phaser.Keyboard.ONE);
	key1.onDown.add(hit1, this);

	key2 = game.input.keyboard.addKey(Phaser.Keyboard.TWO);
	key2.onDown.add(hit2, this);

	key3 = game.input.keyboard.addKey(Phaser.Keyboard.THREE);
	key3.onDown.add(hit3, this);

	key4 = game.input.keyboard.addKey(Phaser.Keyboard.FOUR);
	key4.onDown.add(hit4, this);

	key5 = game.input.keyboard.addKey(Phaser.Keyboard.FIVE);
	key5.onDown.add(hit5, this);

	key6 = game.input.keyboard.addKey(Phaser.Keyboard.SIX);
	key6.onDown.add(hit6, this);

	key7 = game.input.keyboard.addKey(Phaser.Keyboard.SEVEN);
	key7.onDown.add(hit7, this);

	key8 = game.input.keyboard.addKey(Phaser.Keyboard.EIGHT);
	key8.onDown.add(hit8, this);

	key9 = game.input.keyboard.addKey(Phaser.Keyboard.NINE);
	key9.onDown.add(hit9, this);

	key0 = game.input.keyboard.addKey(Phaser.Keyboard.ZERO);
	key0.onDown.add(hit0, this);

	/*
	var addCircles = function(thex, they, sprite, r, g, b) {
		console.log("Hi");
		var numCircles = circles.length;
		var thisCircleId = numCircles + 1;
	}

	addCircle(120, 120, 'circleSunlitsea', 207, 240, 158);
	*/
	var topBorder = 160;
	var leftBorder = 160;
	var circleWidth = 90;
	var horizSpacing = 150;

	var circle1 = circles.create(circleWidth*0 + leftBorder, topBorder, 'circle');
	circle1.tint = '0x1abc9c';

	var circle2 = circles.create(circleWidth*1 + leftBorder + horizSpacing*1, topBorder, 'circle');
	circle2.tint = '0x2ecc71';

	var circle3 = circles.create(circleWidth*2 + leftBorder + horizSpacing*2, topBorder, 'circle');
	circle3.tint = '0x3498db';

	var circle4 = circles.create(circleWidth*3 + leftBorder + horizSpacing*3, topBorder, 'circle');
	circle4.tint = '0x9b59b6';

	var circle5 = circles.create(circleWidth*4 + leftBorder + horizSpacing*4, topBorder, 'circle');
	circle5.tint = '0x34495e';

	var circle6 = circles.create(circleWidth*0 + leftBorder, topBorder*3, 'circle');
	circle6.tint = '0xf1c40f';

	var circle7 = circles.create(circleWidth*1 + leftBorder + horizSpacing*1, topBorder*3, 'circle');
	circle7.tint = '0xe67e22';

	var circle8 = circles.create(circleWidth*2 + leftBorder + horizSpacing*2, topBorder*3, 'circle');
	circle8.tint = '0xe74c3c';

	var circle9 = circles.create(circleWidth*3 + leftBorder + horizSpacing*3, topBorder*3, 'circle');
	circle9.tint = '0x95a5a6';

	var circle10 = circles.create(circleWidth*4 + leftBorder + horizSpacing*4, topBorder*3, 'circle');
	circle10.tint = '0x7f8c8d';

	// Do something to each and every circle
	for (var i=0; i < circles.children.length; i++) {
		var theScale = 0;
		circles.children[i].scale.setTo(theScale, theScale);
		
		circles.children[i].inputEnabled = true;
		circles.children[i].anchor.setTo(0.5, 0.5);
		circles.children[i].name = "circle" + i;

		//circles.children[i].events.onInputDown.add(listener, {circleName: circles.children[i].name});
		//circles.children[i].
	}

	text = game.add.text(10, 10, game.time.fps, { fill: '#ffffff' });

}

/*
function listener() {
	if (_socketEnabled) {
		socket.emit('my other event', { circleName: this.circleName });
	}
	console.log('Clicked ' + this.circleName);
}
*/

function render() {
	//text.setText(game.time.fps);
}

function update() {
	text.setText(game.time.fps);
}

</script>

</body>
</html>
